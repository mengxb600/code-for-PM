function [rth,L]=thsample(u,a,b,c,d,grid)
%  th=[-3.33333333333333,-2.66666666666667,-2,-1.33333333333333,-0.666666666666667,2.22044604925031e-16,0.666666666666667,1.33333333333333,2.00000000000000,2.66666666666667,3.33300000000000];
%  A=[0.00134989803163010,0.00846543059701525,0.0379750236441694,0.110864901658642,0.210786086250307,0.261117319636473,0.210786086250306,0.110864901658642,0.0379750236441694,0.00846543059701521,0.00134989803163010];
th=linspace(-4,4,grid);
A=normpdf(th,0,1);
for i=1:grid
    th1=th(i); 
    p=c+(d-c).*normcdf(a*th1+b,0,1);
    P0(:,i)=prod((p.^u).*(1-p).^(1-u),2);    
end
P1=P0*A';
P2=P0.*A;
p2=P2./P1;
z=mnrnd(1,p2);
th=th';
rth=z*th;
L=sum(log(P1*(th(2)-th(1))));
%L=sum(log(P1*(th(2)-th(1))));
% EAP=p2*th;l

